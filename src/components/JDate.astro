---
const { data } = Astro.props;
---

<j-date data-jdata={JSON.stringify(data)}></j-date>

<script>

  class JDate extends HTMLElement {
    constructor() {
      super();

      let data:JDate.DayObj = JSON.parse(this.dataset.jdata!);

      let date:Date = new Date(data.day);
      const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      let day = date!.getDate();
      let month = monthNames[date!.getMonth()];
      let year = date!.getUTCFullYear();
      let mDate = day + ' ' + month + ' ' + year;

      let url = "/dates/chronology#" + data.alt;

      let html = `<a id="${data.alt}" href="${url}" target="_blank"><b><p title="${data.title}">ðŸ“…&nbsp;${mDate}</p></b></a>`;

      const div = document.createElement('div') as HTMLDivElement;
      div.innerHTML = html;

      this.appendChild(div);

      /*link!.addEventListener('click', () => {
        //window.open(url);
      });*/

    }
}
namespace JDate {
  export interface DayObj {
    alt : string;
    day : Date;
    title: string;
    desc: string;
    location: string;
    map: string;
  }
}
customElements.define('j-date', JDate);
</script>
